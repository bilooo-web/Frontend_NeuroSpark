{"version":3,"file":"read-along.js","sourceRoot":"","sources":["../../../../../../src/components/read-along-component/read-along.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Howl } from \"howler\";\nimport { Subject } from \"rxjs\";\nimport { distinctUntilChanged } from \"rxjs/operators\";\n\nimport {\n  Component,\n  Element,\n  Fragment,\n  h,\n  Listen,\n  Method,\n  Prop,\n  State,\n  Watch,\n} from \"@stencil/core\";\n\nimport {\n  parseRAS,\n  Sprite,\n  extractPages,\n  extractAlignment,\n  isFileAvailable,\n  isIOS,\n  getUserPreferences,\n  USER_PREFERENCE_VERSION,\n  setUserPreferences,\n  extractMeta,\n  sentenceIsAligned,\n  hasUserPreferences,\n  clearUserPreferences,\n} from \"../../utils/utils\";\nimport {\n  Alignment,\n  Page,\n  InterfaceLanguage,\n  ReadAlongMode,\n  UserPreferences,\n  ScrollBehaviour,\n  RASMeta,\n  RASAnnotation,\n} from \"../../index.d\";\nimport { web_component as eng_strings } from \"../../i18n/messages.eng.json\";\nimport { web_component as fra_strings } from \"../../i18n/messages.fra.json\";\nimport { web_component as spa_strings } from \"../../i18n/messages.spa.json\";\nimport { PACKAGE_VERSION } from \"../../version\";\nimport { MatIcon } from \"../../utils/mat-icon\";\nconst LOADING = 0;\nconst LOADED = 1;\nconst ERROR_PARSING = 2;\nconst ERROR_LOADING = 3;\n\ninterface ASSETS_STATUS {\n  AUDIO: number;\n  RAS: number;\n}\n\n// InvalidImageFile is used to track the information of non-image files selected\n// by the user. These are rendered as error messages.\ninterface InvalidImageFile {\n  fileName: string;\n  pageIndex: number;\n}\n\n// The length of time an error message stays on the screen. 0 (and negative)\n// values disables this functionality.\nconst DEFAULT_ERROR_TIMEOUT_MS = 50000;\n\n/**\n * navigatorTheme returns the user's preferred theme, defaults to the\n * light theme.\n */\nfunction navigatorTheme(): string {\n  if (window.matchMedia) {\n    if (window.matchMedia(\"prefers-color-scheme: dark\").matches) {\n      return \"dark\";\n    }\n  }\n\n  return \"light\";\n}\n\n@Component({\n  tag: \"read-along\",\n  styleUrl: \"../../scss/styles.scss\",\n  shadow: true,\n  assetsDirs: [\"assets\"],\n})\nexport class ReadAlongComponent {\n  @Element() el: HTMLElement;\n\n  /************\n   *  PROPS   *\n   ************/\n\n  /**\n   * URL of the aligned text as readalong XML\n   */\n  @Prop() href: string;\n\n  processed_alignment: Alignment;\n\n  /**\n   * URL of the audio file\n   */\n  @Prop() audio: string;\n  audio_howl: Howl;\n  audio_howl_sprites: any;\n  reading$ = new Subject<string>(); // An RxJs Subject for the current item being read.\n  duration: number; // Duration of the audio file\n\n  /**\n   * Overlay\n   * This is an SVG overlay to place over the progress bar\n   */\n  @Prop() svgOverlay: string;\n\n  /**\n   * Theme to use: ['light', 'dark'] defaults to the user's configured theme.\n   */\n  @Prop() theme: string = navigatorTheme();\n\n  /**\n   * Language  of the interface. In 639-3 code.\n   * Options are \"eng\" (English), \"fra\" (French) or \"spa\" (Spanish)\n   */\n  @Prop() language: InterfaceLanguage = \"eng\";\n\n  /**\n   * i18n strings dicts\n   */\n  i18nStrings = { eng: eng_strings, fra: fra_strings, spa: spa_strings };\n\n  /**\n   * Optional custom Stylesheet to override defaults\n   */\n  @Prop({ mutable: true }) cssUrl?: string;\n\n  /**\n   * DEPRECATED\n   * Will be removed in version 2.0.0\n   * Toggle the use of an assets folder. Defaults to undefined.\n   * Previously (<1.2.0) defaulted to 'true'.\n   * .readalong files should just contain base filenames\n   * not the full paths to the images.\n   */\n  @Prop() useAssetsFolder?: boolean;\n\n  /**\n   * Define a path for where the image assets are located\n   * This should be used instead of use-assets-folder.\n   * Defaults to 'assets/'. The empty string means that\n   * image paths will not have a prefix added to them.\n   * Use of the forward slash is optional.\n   */\n  @Prop() imageAssetsFolder: string = \"assets/\";\n\n  /**\n   * Toggles the page scrolling from horizontal to vertical. Defaults to horizontal\n   *\n   */\n  @Prop() pageScrolling: \"horizontal\" | \"vertical\" = \"horizontal\";\n\n  /**\n   * Choose mode of ReadAlong - either view (default) or edit\n   */\n  @Prop() mode: ReadAlongMode = \"VIEW\";\n\n  /**\n   * Select whether scrolling between pages should be \"smooth\" (default nicely\n   * animated, good for fast computers) or \"auto\" (choppy but much less compute\n   * intensive)\n   */\n  @Prop() scrollBehaviour: ScrollBehaviour = \"smooth\";\n\n  /**\n   * Show text translation  on at load time\n   */\n  @Prop() displayTranslation = true;\n\n  /**\n   * Control the range of the playback rate: allow speeds\n   * from 100 - playback-rate-range to 100 + playback-rate-range.\n   */\n  @Prop() playbackRateRange: number = 15;\n\n  /**\n   * Auto Pause at end of every page\n   */\n  @Prop() autoPauseAtEndOfPage = false;\n\n  /************\n   *  STATES  *\n   ************/\n\n  /**\n   * Whether audio is playing or not\n   */\n  @State() playing: boolean = false;\n\n  play_id: number;\n  playback_rate: number = 1;\n\n  @State() fullscreen: boolean = false;\n\n  @State() autoScroll: boolean = true;\n  @State() hasLoaded: number = 0;\n  showGuide: boolean = false;\n\n  parsed_text;\n  dropAreas;\n  current_page;\n  hasTextTranslations: boolean = false;\n  @State() images: { [key: string]: string | null };\n  @State() invalidImages: { [key: string]: InvalidImageFile } = {};\n  @State() translations: { [key: string]: string | null };\n\n  latestTranslation: string; // when a new translation line is added, this is populated with the added HTMLElement's ID which is queried and focused after the component re-renders\n  assetsStatus: ASSETS_STATUS = {\n    AUDIO: LOADING,\n    RAS: LOADING,\n  };\n  alignment_failed: boolean = false;\n  isScrolling: boolean = false;\n  scrollTimer = null;\n\n  handleScrollEvent() {\n    this.isScrolling = true;\n    if (this.scrollTimer) clearTimeout(this.scrollTimer);\n    this.scrollTimer = setTimeout(() => {\n      this.isScrolling = false;\n    }, 125);\n  }\n  autoPauseTimer: any;\n  endOfPageTags: Alignment = {};\n  finalTaggedWord: string;\n  @State() settingsVisible: boolean = false;\n  @State() private userPreferences: UserPreferences;\n  @State() private userPreferencesDirty: boolean = false;\n  @State() private hasUserPreferences: boolean = hasUserPreferences();\n\n  meta: RASMeta = {};\n  @State() annotations: RASAnnotation[] = [];\n  @State() annotationsMenuVisible: boolean = false;\n\n  @Watch(\"audio_howl_sprites\")\n  /************\n   *  LISTENERS  *\n   ************/\n  @Listen(\"wheel\", { target: \"window\" })\n  wheelHandler(event: MouseEvent): void {\n    // only show guide if there is an actual highlighted element\n    if (this.el.shadowRoot.querySelector(\".reading\")) {\n      if (\n        event[\"path\"] &&\n        event[\"path\"].length > 0 &&\n        (event[\"path\"][0].classList.contains(\"sentence__word\") ||\n          event[\"path\"][0].classList.contains(\"sentence__container\") ||\n          event[\"path\"][0].classList.contains(\"sentence\"))\n      ) {\n        if (this.autoScroll) {\n          let reading_el: HTMLElement =\n            this.el.shadowRoot.querySelector(\".reading\");\n          if (reading_el) {\n            this.autoScroll = !this.inPageContentOverflow(reading_el);\n            this.showGuide = !this.autoScroll;\n          }\n        }\n      }\n    }\n  }\n  // handle cases where user presses esc to cancel full screen\n  @Listen(\"fullscreenchange\")\n  fullScreenHandler() {\n    this.fullscreen = window.document.fullscreenElement != null;\n  }\n  @Listen(\"keydown\", { target: \"document\" })\n  handleKeyDown(event: KeyboardEvent) {\n    //dismiss setting modal user pressing escape\n    if (event.key === \"Escape\" && this.settingsVisible) {\n      this.settingsVisible = false;\n    }\n  }\n\n  /***********\n   *  UTILS  *\n   ***********/\n  /**\n   * Transforms a given path to either use the default assets folder or rely on the absolute path given\n   * @param path\n   * @return string\n   */\n  private urlTransform(path: string): string {\n    // Frankenstein of combined useAssetsFolder v1.1.1 functionality and imageAssetsFolder v2.0.0 functionality\n    // TODO: delete this first if statement and all occurrences of useAssetsFolder for v2.0.0\n    if (this.useAssetsFolder !== undefined) {\n      // Old v1.1.1 functionality\n      if (\n        this.useAssetsFolder &&\n        looksLikeRelativePath(path) &&\n        !path.startsWith(\"blob\")\n      ) {\n        return \"assets/\" + path;\n      } else {\n        return path;\n      }\n    } else if (\n      this.imageAssetsFolder &&\n      looksLikeRelativePath(path) &&\n      !path.startsWith(\"blob\")\n    ) {\n      if (this.imageAssetsFolder && !this.imageAssetsFolder.endsWith(\"/\")) {\n        this.imageAssetsFolder += \"/\";\n      }\n      return this.imageAssetsFolder + path;\n    }\n    return path;\n\n    function looksLikeRelativePath(path: string): boolean {\n      return !/^(https?:[/][/]|assets[/]|data:)/.test(path);\n    }\n  }\n\n  /**\n   * Given an audio file path and a parsed alignment object,\n   * build a Sprite object\n   * @param audio\n   * @param alignment\n   */\n  private buildSprite(audio: string, alignment: Alignment) {\n    return new Sprite({\n      src: [audio],\n      sprite: alignment,\n      rate: this.playback_rate,\n    });\n  }\n\n  /**\n   * Add escape characters to query selector param\n   * @param id\n   */\n  tagToQuery(id: string): string {\n    id = id.replace(\".\", \"\\\\.\");\n    id = id.replace(\"#\", \"\\\\#\");\n    return \"#\" + id;\n  }\n\n  /**\n   * Return HTML element of word closest to second s\n   *\n   * @param s seconds\n   */\n  returnWordClosestTo(s: number): HTMLElement {\n    let keys = Object.keys(this.processed_alignment);\n    // remove 'all' sprite as it's not a word.\n    keys.pop();\n    for (let i = 1; i < keys.length; i++) {\n      if (\n        s * 1000 > this.processed_alignment[keys[i]][0] &&\n        this.processed_alignment[keys[i + 1]] &&\n        s * 1000 < this.processed_alignment[keys[i + 1]][0]\n      ) {\n        return this.el.shadowRoot.querySelector(this.tagToQuery(keys[i]));\n      }\n    }\n  }\n\n  /**\n   * Return the file path given the asset_type\n   */\n  getPathFromAssetType(asset_type: string) {\n    if (asset_type === \"AUDIO\") {\n      return this.audio;\n    } else if (asset_type === \"RAS\") {\n      return this.href;\n    } else {\n      return \"Asset Path Not Supported\";\n    }\n  }\n\n  /**\n   * toggle the setting pane visiblilty\n   */\n  toggleSettings() {\n    //pause audio if playing and setting modal is being presented\n\n    if (this.playing) {\n      this.pause();\n    }\n\n    this.settingsVisible = !this.settingsVisible;\n  }\n  /**\n   * toggle (override) scrolling animation\n   */\n  toggleScrollBehavior(): void {\n    this.userPreferences = {\n      ...this.userPreferences,\n      scrollBehaviour:\n        this.userPreferences.scrollBehaviour === \"auto\" ? \"smooth\" : \"auto\",\n    };\n  }\n  /*************\n   *   AUDIO   *\n   *************/\n\n  /**\n   * Change playback between .75 and 1.25. To change the playback options,\n   * change the HTML in the function renderControlPanel\n   *\n   * @param ev\n   */\n  changePlayback(ev: Event): void {\n    let inputEl = ev.currentTarget as HTMLInputElement;\n    this.playback_rate = parseInt(inputEl.value) / 100;\n    this.audio_howl_sprites.sound.rate(this.playback_rate);\n  }\n\n  /**\n   *  Go back s milliseconds\n   *\n   * @param s\n   */\n\n  goBack(s: number): void {\n    this.autoScroll = false;\n    if (this.play_id) {\n      this.audio_howl_sprites.goBack(this.play_id, s);\n    }\n    setTimeout(() => (this.autoScroll = true), 100);\n  }\n\n  /**\n   * Go to seek\n   *\n   * @param seek number\n   *\n   */\n  goTo(seek: number): void {\n    if (this.play_id === undefined) {\n      this.play();\n      this.pause();\n    }\n    //allow display to bring the selected portion into view\n    this.autoScroll = true;\n    seek = seek / 1000;\n    this.audio_howl_sprites.goTo(this.play_id, seek);\n    setTimeout(() => (this.autoScroll = true), 100);\n  }\n\n  /**\n   * Go to seek from id\n   *\n   * @param ev\n   */\n  goToSeekAtEl(ev: MouseEvent): string {\n    let el = ev.currentTarget as HTMLElement;\n    let tag = el.id;\n    let seek = this.processed_alignment[tag][0];\n    this.goTo(seek);\n    return tag;\n  }\n\n  /**\n   * Go to seek from progress bar\n   */\n  goToSeekFromProgress(ev: MouseEvent): void {\n    let el = ev.currentTarget as HTMLElement;\n    let client_rect = el.getBoundingClientRect();\n    // get offset of clicked element\n    let offset = client_rect.left;\n    // get width of clicked element\n    let width = client_rect.width;\n    // get click point\n    let click = ev.pageX - offset;\n    // get seek in milliseconds\n    let seek = (click / width) * this.duration * 1000;\n    this.goTo(seek);\n  }\n\n  /**\n   * Pause audio.\n   */\n  pause(): void {\n    if (this.playing) {\n      this.playing = false;\n      this.audio_howl_sprites.pause();\n    }\n  }\n\n  /**\n   * Play the current audio, or start a new play of all\n   * the audio\n   *\n   *\n   */\n  play() {\n    //do not attempt to play if sprites are not initialized\n    if (this.audio_howl_sprites === undefined) return;\n    this.playing = true;\n    // If already playing once, continue playing\n    if (this.play_id !== undefined) {\n      this.play_id = this.audio_howl_sprites.play(this.play_id);\n    } else {\n      // else, start a new play\n      this.play_id = this.audio_howl_sprites.play(\"all\");\n    }\n    // animate the progress bar\n    this.animateProgress();\n  }\n\n  /**\n   * Seek to an element with id 'id', then play it\n   *\n   * @param ev\n   */\n  playSprite(ev: MouseEvent): void {\n    let tag = this.goToSeekAtEl(ev);\n    if (!this.playing) {\n      this.audio_howl_sprites.play(tag);\n    }\n  }\n\n  /**\n   * Stop the sound and remove all active reading styling\n   */\n  stop(): void {\n    this.playing = false;\n    this.play_id = undefined;\n    if (this.audio_howl_sprites) {\n      this.audio_howl_sprites.stop();\n    }\n\n    this.el.shadowRoot\n      .querySelectorAll(\".reading\")\n      .forEach((x) => x.classList.remove(\"reading\"));\n\n    if (!this.autoScroll) {\n      this.autoScroll = true;\n      this.showGuide = false;\n    }\n  }\n\n  /**\n   * toggle the visibility of translation text\n   */\n  toggleTextTranslation(): void {\n    this.el.shadowRoot\n      .querySelectorAll(\".translation, .sentence__translation, [annotation-id]\")\n      .forEach((translation) => translation.classList.toggle(\"invisible\"));\n  }\n\n  /**\n   * Toggle the visibility of annotation layers (sentences)\n   * if id is set to * it toggles all layers\n   * @param annotationId\n   */\n  toggleTextAnnotation(annotationId: string): void {\n    this.el.shadowRoot\n      .querySelectorAll(\n        \"[annotation-id\" +\n          (annotationId === \"*\" ? \"]\" : '=\"' + annotationId + '\"]'),\n      )\n      .forEach((annotationElem) =>\n        annotationElem.classList.toggle(\"invisible\"),\n      );\n    this.annotations = this.annotations.map((annotationObj) => {\n      if (annotationObj.id == annotationId || annotationId === \"*\")\n        annotationObj.isVisible = !annotationObj.isVisible;\n      return annotationObj;\n    });\n  }\n\n  /*************\n   * ANIMATION *\n   *************/\n\n  /**\n   * Remove highlighting from every other word and add it to el\n   *\n   * @param el\n   */\n  addHighlightingTo(el: HTMLElement): void {\n    this.el.shadowRoot\n      .querySelectorAll(\".reading\")\n      .forEach((x) => x.classList.remove(\"reading\"));\n    el.classList.add(\"reading\");\n  }\n\n  /**\n   * Animate the progress through the overlay svg\n   */\n  animateProgressWithOverlay(): void {\n    // select svg container\n    let wave__container: any =\n      this.el.shadowRoot.querySelector(\"#overlay__object\");\n    // use svg container to grab fill and trail\n    let fill: HTMLElement =\n      wave__container.contentDocument.querySelector(\"#progress-fill\");\n    let trail =\n      wave__container.contentDocument.querySelector(\"#progress-trail\");\n    let base = wave__container.contentDocument.querySelector(\"#progress-base\");\n    fill.classList.add(\"stop-color--\" + this.userPreferences.theme);\n    base.classList.add(\"stop-color--\" + this.userPreferences.theme);\n\n    // push them to array to be changed in step()\n    this.audio_howl_sprites.sounds.push(fill);\n    this.audio_howl_sprites.sounds.push(trail);\n    // When this sound is finished, remove the progress element.\n    this.audio_howl_sprites.sound.once(\n      \"end\",\n      () => {\n        this.audio_howl_sprites.sounds.forEach((x) => {\n          x.setAttribute(\"offset\", \"0%\");\n        });\n        this.el.shadowRoot\n          .querySelectorAll(\".reading\")\n          .forEach((x) => x.classList.remove(\"reading\"));\n        this.playing = false;\n        // }\n      },\n      this.play_id,\n    );\n  }\n\n  /**\n   * Animate the progress if no svg overlay is provided\n   *\n   * @param play_id\n   * @param tag\n   */\n  animateProgressDefault(play_id: number, tag: string): void {\n    let elm = document.createElement(\"div\");\n    elm.className = \"progress theme--\" + this.userPreferences.theme;\n    elm.id = play_id.toString();\n    elm.dataset.sprite = tag;\n    let query = this.tagToQuery(tag);\n    this.el.shadowRoot.querySelector(query).appendChild(elm);\n    this.audio_howl_sprites.sounds.push(elm);\n\n    // When this sound is finished, remove the progress element.\n    this.audio_howl_sprites.sound.once(\n      \"end\",\n      () => {\n        // this.audio_howl_sprites = [];\n        this.el.shadowRoot\n          .querySelectorAll(\".reading\")\n          .forEach((x) => x.classList.remove(\"reading\"));\n        this.playing = false;\n        // }\n      },\n      this.play_id,\n    );\n  }\n\n  /**\n   * Animate progress, either by default or with svg overlay.\n   */\n  animateProgress(play_id = this.play_id): void {\n    // Start animating progress\n    if (this.svgOverlay) {\n      // either with svg overlay\n      this.animateProgressWithOverlay();\n    } else if (play_id) {\n      // or default progress bar\n      this.animateProgressDefault(play_id, \"all\");\n    }\n  }\n\n  /**\n   * Change fill colour to match theme\n   */\n  changeFill(): void {\n    // Get theme contrast from the computed color of a word\n    let contrast_el = this.el.shadowRoot.querySelector(\".sentence__word\");\n    let contrast = window.getComputedStyle(contrast_el).color;\n\n    // select svg container\n    let wave__container: any =\n      this.el.shadowRoot.querySelector(\"#overlay__object\");\n\n    // use svg container to grab fill and trail\n    let fill = wave__container.contentDocument.querySelector(\"#progress-fill\");\n    let base = wave__container.contentDocument.querySelector(\"#progress-base\");\n\n    // select polygon\n    let polygon = wave__container.contentDocument.querySelector(\"#polygon\");\n    polygon.setAttribute(\"stroke\", contrast);\n\n    base.setAttribute(\"stop-color\", contrast);\n    fill.setAttribute(\"stop-color\", contrast);\n  }\n\n  /**\n   * Get Current Word\n   */\n  @Method()\n  async getCurrentWord(): Promise<Subject<string>> {\n    return this.reading$;\n  }\n\n  /**\n   * Get Images\n   */\n  @Method()\n  async getImages(): Promise<object> {\n    return this.images;\n  }\n\n  /**\n   * Update Single Sprite\n   */\n  @Method()\n  async updateSpriteAlignments(alignment: Alignment): Promise<void> {\n    this.stop();\n    this.processed_alignment = alignment;\n    this.attachScrollingLogicToAudio();\n  }\n\n  /**\n   * Get ReadAlong Element\n   */\n  @Method()\n  async getReadAlongElement(): Promise<Element> {\n    return this.el;\n  }\n\n  /**\n   * Get Alignments\n   */\n  @Method()\n  async getAlignments(): Promise<Alignment> {\n    return this.processed_alignment;\n  }\n\n  /**\n   * Get Translations\n   */\n  @Method()\n  async getTranslations(): Promise<object> {\n    return this.translations;\n  }\n\n  /**\n   * Change theme\n   */\n  @Method()\n  async changeTheme(): Promise<void> {\n    const newTheme = this.userPreferences.theme === \"light\" ? \"dark\" : \"light\";\n    this.userPreferences = { ...this.userPreferences, theme: newTheme };\n  }\n  /**\n   * Update stylesheet\n   * @param url\n   */\n  @Method()\n  async setCss(url) {\n    this.cssUrl = url;\n  }\n\n  /**\n   * Add custom font\n   */\n  @Method()\n  async addCustomFont(fontData: string) {\n    const style = document.createElement(\"style\");\n    style.setAttribute(\"id\", \"ra-wc-custom-font\");\n    style.setAttribute(\"type\", \"text/css\");\n    style.innerHTML = fontData;\n    document.head.appendChild(style);\n  }\n  /**\n   * Return the Sentence Container of Word\n   * Currently the 3rd parent up the tree node\n   * @param element\n   * @private\n   */\n  private static _getSentenceContainerOfWord(\n    element: HTMLElement,\n  ): HTMLElement {\n    return element.parentElement.parentElement.parentElement;\n  }\n\n  /**\n   * Make Fullscreen\n   */\n  private toggleFullscreen(): void {\n    let fullScreenPromise;\n    if (!this.fullscreen) {\n      let elem: any = this.el.shadowRoot.getElementById(\"read-along-container\");\n\n      if (elem.requestFullscreen) {\n        fullScreenPromise = elem.requestFullscreen();\n      } else if (elem.mozRequestFullScreen) {\n        /* Firefox */\n        fullScreenPromise = elem.mozRequestFullScreen();\n      } else if (elem.webkitRequestFullscreen) {\n        /* Chrome, Safari and Opera */\n        fullScreenPromise = elem.webkitRequestFullscreen();\n      } else if (elem.msRequestFullscreen) {\n        /* IE/Edge */\n        fullScreenPromise = elem.msRequestFullscreen();\n      }\n      fullScreenPromise.then(() => {\n        this.fullscreen = true;\n        this.el.shadowRoot\n          .getElementById(\"read-along-container\")\n          .classList.add(\"read-along-container--fullscreen\");\n      });\n    } else {\n      let document: any = this.el.ownerDocument;\n      if (document.exitFullscreen) {\n        fullScreenPromise = document.exitFullscreen();\n      } else if (document.mozCancelFullScreen) {\n        /* Firefox */\n        fullScreenPromise = document.mozCancelFullScreen();\n      } else if (document.webkitExitFullscreen) {\n        /* Chrome, Safari and Opera */\n        fullScreenPromise = document.webkitExitFullscreen();\n      } else if (document.msExitFullscreen) {\n        /* IE/Edge */\n        fullScreenPromise = document.msExitFullscreen();\n      }\n      fullScreenPromise.then(() => {\n        this.fullscreen = false;\n        this.el.shadowRoot\n          .getElementById(\"read-along-container\")\n          .classList.remove(\"read-along-container--fullscreen\");\n      });\n    }\n  }\n\n  /*************\n   * SCROLLING *\n   *************/\n\n  hideGuideAndScroll(): void {\n    let reading_el: HTMLElement = this.el.shadowRoot.querySelector(\".reading\");\n    // observe when element is scrolled to, then remove the scroll guide and unobserve\n    let intersectionObserver = new IntersectionObserver((entries) => {\n      let [entry] = entries;\n      if (entry.isIntersecting) {\n        setTimeout(() => {\n          this.showGuide = false;\n          this.autoScroll = true;\n        }, 100);\n        intersectionObserver.unobserve(reading_el);\n      }\n    });\n    intersectionObserver.observe(reading_el);\n    this.scrollTo(reading_el);\n  }\n\n  //for when you visually align content\n  inParagraphContentOverflow(element: HTMLElement): boolean {\n    let para_el = ReadAlongComponent._getSentenceContainerOfWord(element);\n    let para_rect = para_el.getBoundingClientRect();\n    let el_rect = element.getBoundingClientRect();\n\n    // element being read is left of the words being viewed\n    let inOverflowLeft = el_rect.right < para_rect.left;\n    // element being read is right of the words being viewed\n    let inOverflowRight = el_rect.right > para_rect.right;\n\n    let intersectionObserver = new IntersectionObserver((entries) => {\n      let [entry] = entries;\n      if (entry.isIntersecting) {\n        setTimeout(() => {\n          this.showGuide = false;\n          this.autoScroll = true;\n        }, 100);\n        intersectionObserver.unobserve(element);\n      }\n    });\n    intersectionObserver.observe(element);\n    // if not in overflow, return false\n    return inOverflowLeft || inOverflowRight;\n  }\n\n  inPageContentOverflow(element: HTMLElement): boolean {\n    let page_el = this.el.shadowRoot.querySelector(\"#\" + this.current_page);\n    let page_rect = page_el.getBoundingClientRect();\n    let el_rect = element.getBoundingClientRect();\n\n    // element being read is below/ahead of the words being viewed\n    let inOverflowBelow =\n      el_rect.top + el_rect.height > page_rect.top + page_rect.height;\n    // element being read is above/behind of the words being viewed\n    //even if it is barely above the view\n    let inOverflowAbove = el_rect.top < page_rect.top;\n\n    let intersectionObserver = new IntersectionObserver((entries) => {\n      let [entry] = entries;\n      if (entry.isIntersecting) {\n        setTimeout(() => {\n          this.showGuide = false;\n          this.autoScroll = true;\n        }, 100);\n        // IT IS VISIBLE\n        inOverflowAbove = inOverflowBelow = false;\n        intersectionObserver.unobserve(element);\n      }\n    });\n    intersectionObserver.observe(element);\n\n    // if not in overflow, return false\n    return inOverflowAbove || inOverflowBelow;\n  }\n\n  inPage(element: HTMLElement): boolean {\n    let sent_el = ReadAlongComponent._getSentenceContainerOfWord(element);\n    let sent_rect = sent_el.getBoundingClientRect();\n    let el_rect = element.getBoundingClientRect();\n    // element being read is below/ahead of the words being viewed\n    let inOverflowBelow =\n      el_rect.top + el_rect.height > sent_rect.top + sent_rect.height;\n    // element being read is above/behind of the words being viewed\n    let inOverflowAbove = el_rect.top + el_rect.height < 0;\n\n    let intersectionObserver = new IntersectionObserver((entries) => {\n      let [entry] = entries;\n      if (entry.isIntersecting) {\n        setTimeout(() => {\n          this.showGuide = false;\n          this.autoScroll = true;\n        }, 100);\n        intersectionObserver.unobserve(element);\n      }\n    });\n    intersectionObserver.observe(element);\n\n    // if not in overflow, return false\n    return inOverflowAbove || inOverflowBelow;\n  }\n\n  scrollToPage(pg_id: string): void {\n    let page_container: any =\n      this.el.shadowRoot.querySelector(\".pages__container\");\n    let next_page: any = this.el.shadowRoot.querySelector(\"#\" + pg_id);\n    page_container.scrollBy({\n      top:\n        this.pageScrolling.match(\"vertical\") != null\n          ? next_page.offsetTop - page_container.scrollTop\n          : 0,\n      left:\n        this.pageScrolling.match(\"vertical\") != null\n          ? 0\n          : next_page.offsetLeft - page_container.scrollLeft,\n      behavior: this.userPreferences.scrollBehaviour,\n    });\n    next_page.scrollTo(0, 0); //reset to top of the page\n  }\n\n  scrollByHeight(el: HTMLElement): void {\n    let sent_container = ReadAlongComponent._getSentenceContainerOfWord(el); //get the direct parent sentence container\n\n    let anchor = el.parentElement.getBoundingClientRect();\n\n    let intersectionObserver = new IntersectionObserver(\n      (entries) => {\n        let [entry] = entries;\n        if (entry.isIntersecting) {\n          intersectionObserver.unobserve(el);\n        } else {\n          sent_container.scrollTo({\n            top: sent_container.getBoundingClientRect().height - anchor.height, // negative value\n            // acceptable\n            left: 0,\n            behavior: this.userPreferences.scrollBehaviour,\n          });\n        }\n      },\n      {\n        root: sent_container,\n        threshold: [0, 0.25, 0.5, 0.75, 1],\n      },\n    );\n    intersectionObserver.observe(el);\n  }\n\n  //scrolling within the visually aligned paragraph\n  scrollByWidth(el: HTMLElement): void {\n    let sent_container = ReadAlongComponent._getSentenceContainerOfWord(el); //get the direct parent sentence container\n\n    let anchor = el.getBoundingClientRect();\n    sent_container.scrollTo({\n      left: anchor.left - 10, // negative value acceptable\n      top: 0,\n      behavior: this.userPreferences.scrollBehaviour,\n    });\n  }\n\n  scrollTo(el: HTMLElement): void {\n    el.scrollIntoView({\n      behavior: this.userPreferences.scrollBehaviour,\n    });\n  }\n\n  /*************\n   * LIFECYCLE *\n   *************/\n\n  /**\n   * When the component is disconnected, stop all audio.\n   *\n   */\n\n  disconnectedCallback() {\n    this.stop();\n  }\n\n  /**\n   * When the component updates, change the fill of the progress bar.\n   * This is because the fill colour is determined by a computed CSS\n   * value set by the Web Component's theme. When the @prop theme changes and\n   * the component updates, we have to update the fill with the new\n   * computed CSS value.\n   */\n  componentDidUpdate() {\n    if (this.svgOverlay) {\n      this.changeFill();\n    }\n  }\n\n  /**\n   * construct a valid default user preferences object, using the provided\n   * component properties.\n   */\n  private defaultUserPreferences(): UserPreferences {\n    const prefs: UserPreferences = {\n      version: USER_PREFERENCE_VERSION,\n      autoPauseAtEndOfPage: this.autoPauseAtEndOfPage,\n      scrollBehaviour: this.scrollBehaviour.toLowerCase() as ScrollBehaviour,\n      language: this.language.toLowerCase() as InterfaceLanguage,\n      theme: this.theme.toLowerCase(),\n    };\n\n    // Make sure scroll-behaviour is valid\n    if (\n      prefs.scrollBehaviour !== \"smooth\" &&\n      prefs.scrollBehaviour !== \"auto\"\n    ) {\n      console.error(\"Invalid scroll-behaviour value, using default (smooth)\");\n      prefs.scrollBehaviour = \"smooth\";\n    }\n\n    // The backward compatible behaviour used to be audio, alignment and text files outside assets\n    // and only image files inside assets.\n    // See version 0.1.0, where it only looks in assets/ for images, nothing else.\n    // TO maintain backwards compatibility handle assets url\n    //this.audio = this.urlTransform(this.audio)\n    //this.alignment = this.urlTransform(this.alignment)\n    //this.text = this.urlTransform(this.text)\n    //this.cssUrl = this.urlTransform(this.cssUrl)\n\n    // Maintains backwards compatibility with ISO 639-1 language codes.\n    const acceptedLanguages: Record<string, InterfaceLanguage> = {\n      en: \"eng\",\n      eng: \"eng\",\n      fr: \"fra\",\n      fra: \"fra\",\n      es: \"spa\",\n      spa: \"spa\",\n    };\n    prefs.language = acceptedLanguages[prefs.language] || \"eng\";\n\n    return prefs;\n  }\n\n  /**\n   * Using this Lifecycle hook to handle backwards compatibility of component attribute\n   */\n  async componentWillLoad() {\n    this.userPreferences = getUserPreferences();\n    if (!this.userPreferences) {\n      this.userPreferences = this.defaultUserPreferences();\n    }\n\n    // Make sure playback-rate-range is valid\n    if (\n      isNaN(this.playbackRateRange) ||\n      this.playbackRateRange < 0 ||\n      this.playbackRateRange > 99\n    ) {\n      console.error(\"Invalid playback-rate-range value, using default (15).\");\n      this.playbackRateRange = 15;\n    }\n\n    // TODO: if parseRAS has an error, we need ERROR_PARSING\n    // Parse the text to be displayed\n    const text = this.el.querySelector(\"read-along > text\");\n    if (text) {\n      this.parsed_text = extractPages(text);\n      this.meta = extractMeta(this.el);\n    } else {\n      const doc = await parseRAS(this.href);\n\n      this.parsed_text = doc.pages;\n      this.meta = doc.meta;\n    }\n    if (this.parsed_text === null) {\n      this.parsed_text = [];\n      this.assetsStatus.RAS = ERROR_LOADING;\n    } else if (this.parsed_text.length === 0) {\n      this.assetsStatus.RAS = ERROR_PARSING;\n    } else {\n      this.images = {};\n      this.translations = {};\n      for (const [i, page] of this.parsed_text.entries()) {\n        if (\"img\" in page) {\n          var imageURL = this.urlTransform(page.img);\n          this.images[i] = this.urlTransform(page.img);\n          if (/^(https?:[/]|assets)[/]\\b/.test(imageURL)) {\n            let isAvailable = await isFileAvailable(imageURL);\n            if (!isAvailable) {\n              this.images[i] = null;\n            }\n          }\n        } else {\n          this.images[i] = null;\n        }\n        //get the ids for the last word on each the page\n        if (\"paragraphs\" in page) {\n          try {\n            const paragraphs = (page as Page).paragraphs;\n            const sentences = paragraphs[\n              paragraphs.length - 1\n            ].querySelectorAll(\n              \"s:not(.translation), s:not(.sentence__translation)\",\n            ); //get non-translation sentences in the last paragraph\n            const word =\n              sentences[sentences.length - 1].querySelector(\"w:last-of-type\"); //get the last word of the last sentence\n            this.endOfPageTags[word.id] = [\n              parseFloat(word.getAttribute(\"time\")), //in seconds\n              parseFloat(word.getAttribute(\"dur\")) * 1000, // in milliseconds\n            ];\n            this.finalTaggedWord = word.id; // do not pause on the last word of the read-along\n          } catch (err) {}\n\n          let lastAlignedSentenceId: string | null = null;\n          //get the translations\n          page.paragraphs\n            .map((paragraph) => paragraph.querySelectorAll(\"s\"))\n            .forEach((sentences) => {\n              if (sentences.length) {\n                sentences.forEach((sentence) => {\n                  if (sentence.id && sentenceIsAligned(sentence)) {\n                    lastAlignedSentenceId = `${sentence.id}`;\n                  } else if (/translation/.test(sentence.className)) {\n                    const translation: { [key: string]: string } = {};\n                    if ((sentence as Element).hasAttribute(\"sentence-id\")) {\n                      let sentenceID = (sentence as Element).getAttribute(\n                        \"sentence-id\",\n                      );\n\n                      translation[sentenceID] = sentence.textContent;\n                      this.translations = {\n                        ...this.translations,\n                        ...translation,\n                      };\n                    } else if (lastAlignedSentenceId != null) {\n                      translation[lastAlignedSentenceId] = sentence.textContent;\n                      lastAlignedSentenceId = null;\n                      this.translations = {\n                        ...this.translations,\n                        ...translation,\n                      };\n                    }\n                  }\n                });\n              }\n            });\n        }\n      }\n      // this.parsed_text.map((page, i) => page.img ? [i, page.img] : [i, null])\n      /**\n       * parse defined annotations information from the .readalong meta\n       * annotations-id defines the id of each layer\n       * annotations-labels defines the display label for each layer\n       * annotations-label-{locale} defines the localized display label for each layer\n       * all lists are delimited by comma\n       */\n      if (this.meta[\"annotations-ids\"]) {\n        const delimiter = \",\";\n        const labels: string | undefined = this.meta[\n          \"annotations-labels-\" + this.userPreferences.language\n        ]\n          ? this.meta[\"annotations-labels-\" + this.userPreferences.language]\n          : this.meta[\"annotations-labels\"];\n        const annotationNames = labels ? labels.split(delimiter) : [];\n        this.meta[\"annotations-ids\"]\n          .split(delimiter)\n          .forEach((annotation, l) => {\n            this.annotations.push({\n              isVisible: false, //hide by default\n              name: annotationNames[l].trim() ?? annotation.trim(),\n              id: annotation.trim(),\n            });\n          });\n      }\n      this.assetsStatus.RAS = LOADED;\n    }\n    this.hasLoaded += 1;\n  }\n\n  /**\n   * Lifecycle hook: after component loads, build the Sprite and parse the files necessary.\n   * Then subscribe to the _reading$ Subject in order to update CSS styles when new element\n   * is being read\n   */\n  componentDidLoad() {\n    const bcSansFontCssUrl =\n      \"https://unpkg.com/@bcgov/bc-sans@1.0.1/css/BCSans.css\";\n    const iconsFontCssUrl =\n      \"https://fonts.googleapis.com/css2?family=Material+Icons&family=Material+Icons+Outlined&display=swap\";\n\n    [bcSansFontCssUrl, iconsFontCssUrl]\n      .filter((url) => !document.querySelector(`link[href=\"${url}\"]`))\n      .forEach((url) => {\n        const el = document.createElement(\"link\");\n        el.setAttribute(\"rel\", \"stylesheet\");\n        el.setAttribute(\"href\", url);\n        document.head.appendChild(el);\n      });\n\n    this.processed_alignment = extractAlignment(this.parsed_text);\n    this.alignment_failed = Object.keys(this.processed_alignment).length == 0;\n    // load basic Howl\n    this.audio_howl = new Howl({\n      src: [this.audio],\n      html5: isIOS(),\n      preload: false,\n    });\n    // Once loaded, get duration and build Sprite\n    this.audio_howl.once(\"load\", () => {\n      this.attachScrollingLogicToAudio();\n    });\n    // Handle load errors\n    this.audio_howl.once(\"loaderror\", () => {\n      this.hasLoaded += 1;\n      this.assetsStatus.AUDIO = ERROR_LOADING;\n    });\n    this.audio_howl.load();\n  }\n\n  attachScrollingLogicToAudio(): void {\n    this.processed_alignment[\"all\"] = [0, this.audio_howl.duration() * 1000];\n    this.duration = this.audio_howl.duration();\n    this.audio_howl_sprites = this.buildSprite(\n      this.audio,\n      this.processed_alignment,\n    );\n    // Once Sprites are built, subscribe to reading subject and update element class\n    // when new distinct values are emitted\n    this.audio_howl_sprites._reading$\n      .pipe(distinctUntilChanged())\n      .subscribe((el_tag) => {\n        // Update the main reading tag subject\n        this.reading$.next(el_tag);\n        //if stop\n        if (el_tag == \"\") return;\n\n        //if auto pause is active and not on last word of the read along pause the audio\n        if (\n          this.playing &&\n          this.userPreferences.autoPauseAtEndOfPage &&\n          el_tag in this.endOfPageTags &&\n          this.finalTaggedWord !== el_tag\n        ) {\n          //clear previous timeout if active\n          if (this.autoPauseTimer) window.clearTimeout(this.autoPauseTimer);\n          //pause 25ms before end of word\n          this.autoPauseTimer = window.setTimeout(() => {\n            this.pause();\n          }, this.endOfPageTags[el_tag][1] - 25);\n        }\n        // Turn tag to query\n        let query = this.tagToQuery(el_tag);\n        if (query === undefined) return; // not go any further if tag does not exist in the DOM\n        // select the element with that tag\n        let query_el: HTMLElement = this.el.shadowRoot.querySelector(query);\n        // Remove all elements with reading class\n        this.el.shadowRoot\n          .querySelectorAll(\".reading\")\n          .forEach((x) => x.classList.remove(\"reading\"));\n        // Add reading to the selected el\n        query_el.classList.add(\"reading\");\n\n        // Scroll horizontally (to different page) if needed\n        let current_page =\n          ReadAlongComponent._getSentenceContainerOfWord(query_el).parentElement\n            .id;\n\n        if (current_page !== this.current_page) {\n          if (this.current_page !== undefined && !this.isScrolling) {\n            this.scrollToPage(current_page);\n          }\n          this.current_page = current_page;\n        }\n        const leftEdge =\n          Math.ceil(\n            this.el.shadowRoot\n              .querySelector(\".pages__container\")\n              .getBoundingClientRect().left,\n          ) + 1;\n        const pageLeftEdge = Math.ceil(\n          this.el.shadowRoot\n            .querySelector(\"#\" + this.current_page)\n            .getBoundingClientRect().left,\n        );\n\n        //if the user has scrolled away from the from the current page bring them page\n        if (\n          query_el.getBoundingClientRect().left < 0 ||\n          pageLeftEdge !== leftEdge\n        ) {\n          if (!this.isScrolling) this.scrollToPage(current_page);\n        }\n\n        // scroll vertically (through paragraph) if needed\n        if (this.inPageContentOverflow(query_el)) {\n          if (this.autoScroll) {\n            query_el.scrollIntoView({ block: \"start\", inline: \"nearest\" });\n            if (!this.isScrolling) this.scrollByHeight(query_el);\n          }\n        } // scroll horizontal (through paragraph) if needed\n        if (this.inParagraphContentOverflow(query_el)) {\n          if (this.autoScroll) {\n            query_el.scrollIntoView(false);\n            if (!this.isScrolling) this.scrollByWidth(query_el);\n          }\n        }\n      });\n    this.hasLoaded += 1;\n    this.assetsStatus.AUDIO = LOADED;\n  }\n\n  componentDidRender(): void {\n    //if creator does not want the translation to show at load time\n    if (\n      !this.displayTranslation &&\n      this.parsed_text &&\n      this.parsed_text.length > 0\n    ) {\n      this.toggleTextTranslation();\n      this.displayTranslation = true;\n    }\n\n    if (this.latestTranslation) {\n      // Add focus to the latest translation line that was added\n      let newLine: HTMLElement = this.el.shadowRoot.querySelector(\n        this.latestTranslation,\n      );\n      newLine.focus();\n      this.latestTranslation = \"\";\n    }\n  }\n  /**\n   * Is the App ready to start playing\n   * This could be expressed as one line\n   * but because there are multiple states involved\n   * breaking it down to make it easier to track\n   */\n  isReadyToPlay(): boolean {\n    //not ready if still audio & alignment is not loaded\n    if (this.hasLoaded < 2) return false;\n\n    //not ready if\n    if (this.audio_howl_sprites === undefined) return false;\n\n    //not ready if\n    if (this.audio_howl_sprites.sound === undefined) return false;\n\n    return true; //it is ready\n  }\n  /**********\n   *  LANG  *\n   **********/\n\n  /**\n   * Helper function for getI18nString()\n   * @param key  the key of the string to lookup\n   * @returns the requested string found i18n/messages.{this.language}.json\n   */\n  getRawI18nString(key: string): string {\n    if (\n      this.i18nStrings[this.userPreferences.language] &&\n      this.i18nStrings[this.userPreferences.language][key]\n    ) {\n      return this.i18nStrings[this.userPreferences.language][key];\n    } else if (this.i18nStrings.eng[key]) {\n      // Fallback to English if the string does not exist for this.language\n      return this.i18nStrings.eng[key];\n    } else {\n      // Last fallback in case it's not found anywhere, because we never want to just fail\n      return key;\n    }\n  }\n\n  /**\n   * Any text used in the Web Component should be at least bilingual in English and French.\n   * To add a new term, add a new key to each messages.*.json file in ../../i18n\n   * and give the translations as values.\n   *\n   * Subsitution semantics: given substitution = { \"STR1\": \"value1\", \"STR2\": \"value2\" },\n   * the text \"foo <STR1> bar <STR2> baz\" will replaced by \"foo value1 bar value2 baz\".\n   *\n   * @param key  short name for the text to fetch\n   * @param substitutions  optional list of subtitutions to perform\n   * @returns  the string in language this.language for key\n   */\n  getI18nString(\n    key: string,\n    substitutions: { readonly [index: string]: string } = {},\n  ): string {\n    let result: string = this.getRawI18nString(key);\n    for (const [sub_key, value] of Object.entries(substitutions)) {\n      result = result.replace(\"<\" + sub_key + \">\", value);\n    }\n    return result;\n  }\n\n  /**********\n   *  EDIT  *\n   **********/\n\n  addLine(sentence_element: Element) {\n    if (!this.hasTextTranslations) {\n      this.hasTextTranslations = true;\n    }\n    let newTranslation = {};\n\n    newTranslation[sentence_element.id] = \"\";\n    this.translations = { ...this.translations, ...newTranslation };\n    this.latestTranslation = \"#\" + sentence_element.id + \"translation\";\n  }\n\n  removeLine(sentence_element: Element) {\n    delete this.translations[sentence_element.id];\n    this.translations = { ...this.translations };\n  }\n\n  updateTranslation(sentence_id: string, text: string) {\n    this.translations[sentence_id] = text;\n    //console.log(JSON.stringify(this.translations));\n  }\n\n  handleImageFile(file: File, pageIndex: number) {\n    // verify the user has uploaded an  image file.\n    if (!file.type.toLowerCase().startsWith(\"image/\")) {\n      this.invalidImages[pageIndex] = {\n        fileName: file.name,\n        pageIndex: pageIndex,\n      };\n      this.invalidImages = { ...this.invalidImages };\n      return;\n    }\n\n    // forcibly remove the error message associated\n    // with this page.\n    if (pageIndex in this.invalidImages) {\n      delete this.invalidImages[pageIndex];\n      this.invalidImages = { ...this.invalidImages };\n    }\n\n    this.images[pageIndex] = URL.createObjectURL(file);\n    this.images = { ...this.images }; // Using spread operator as advised https://stenciljs.com/docs/reactive-data#updating-an-object\n  }\n\n  deleteImage(pageIndex: number) {\n    // release memory allocated by createObjectURL\n    if (this.images[pageIndex].startsWith(\"blob:\")) {\n      URL.revokeObjectURL(this.images[pageIndex]);\n    }\n\n    const newImage = {};\n    newImage[pageIndex] = null;\n\n    this.images = { ...this.images, ...newImage }; // Using spread operator as advised https://stenciljs.com/docs/reactive-data#updating-an-object\n  }\n\n  /**********\n   * RENDER *\n   **********/\n\n  /**\n   * The Guide element\n   */\n  Guide = (): Element => (\n    <button\n      class={\n        \"scroll-guide__container ripple ui-button theme--\" +\n        this.userPreferences.theme\n      }\n      onClick={() => this.hideGuideAndScroll()}\n    >\n      <span class={\"scroll-guide__text theme--\" + this.userPreferences.theme}>\n        {this.getI18nString(\"re-align\")}\n      </span>\n    </button>\n  );\n\n  /**\n   * Render svg overlay\n   */\n  Overlay = (): Element => (\n    <object\n      onClick={(e) => this.goToSeekFromProgress(e)}\n      id=\"overlay__object\"\n      type=\"image/svg+xml\"\n      data={this.svgOverlay}\n    />\n  );\n\n  /**\n   * Remove image at given page\n   *\n   * @param props\n   */\n  RemoveImg = (props: { pageIndex: number }): Element => {\n    return (\n      <button\n        data-test-id=\"delete-button\"\n        aria-label=\"Delete\"\n        title=\"Delete image\"\n        onClick={() => this.deleteImage(props.pageIndex)}\n        id=\"img-remover\"\n        class={\n          \"ripple theme--\" +\n          this.userPreferences.theme +\n          \" background--\" +\n          this.userPreferences.theme\n        }\n      >\n        <MatIcon>delete</MatIcon>\n      </button>\n    );\n  };\n\n  /**\n   * Render image at path 'url' in assets folder.\n   *\n   * @param props\n   */\n  Img = (props: { imgURL: string; pageIndex: number }): Element => {\n    return (\n      <div\n        class={\n          \"image__container page__col__image theme--\" +\n          this.userPreferences.theme\n        }\n      >\n        {this.mode === \"EDIT\" && (\n          <span id=\"image-container\">\n            <this.RemoveImg pageIndex={props.pageIndex} />\n          </span>\n        )}\n\n        <img alt={\"image\"} class=\"image\" src={props.imgURL} />\n      </div>\n    );\n  };\n\n  ImgPlaceHolder = (props: { pageID: string; pageIndex: number }): Element => {\n    return (\n      <div\n        class={\n          \"image__container page__col__image theme--\" +\n          this.userPreferences.theme\n        }\n      >\n        <div class=\"drop-area\">\n          <form class=\"my-form\">\n            <p class={\"theme--\" + this.userPreferences.theme}>\n              {this.getI18nString(\"upload-image\")}\n            </p>\n            <input\n              type=\"file\"\n              class=\"fileElem\"\n              id={\"fileElem--\" + props.pageID}\n              accept=\"image/*\"\n              onChange={($event: Event) => {\n                const el = $event.target as HTMLInputElement;\n                if (el.files.length === 0) {\n                  return;\n                }\n\n                this.handleImageFile(el.files[0], props.pageIndex);\n                el.value = \"\";\n              }}\n            />\n            <label class=\"button\" htmlFor={\"fileElem--\" + props.pageID}>\n              {this.getI18nString(\"choose-file\")}\n            </label>\n          </form>\n        </div>\n      </div>\n    );\n  };\n\n  /**\n   * Page Counter element\n   *\n   * @param props\n   *\n   * Shows currentPage / pgCount\n   */\n  PageCount = (props: { pgCount: number; currentPage: number }): Element => (\n    <div class={\"page__counter color--\" + this.userPreferences.theme}>\n      {this.getI18nString(\"page\")}{\" \"}\n      <span data-test-id=\"page-count__current\">{props.currentPage}</span>\n      {\" / \"}\n      <span data-test-id=\"page-count__total\">{props.pgCount}</span>\n    </div>\n  );\n\n  ImgContainer = (props: { pageIndex: number; pageID: string }): Element => {\n    const hasImage =\n      props.pageIndex in this.images && this.images[props.pageIndex] !== null;\n\n    if (hasImage) {\n      return (\n        <this.Img\n          imgURL={this.images[props.pageIndex]}\n          pageIndex={props.pageIndex}\n        />\n      );\n    }\n\n    if (this.mode === \"EDIT\") {\n      return (\n        <this.ImgPlaceHolder\n          pageID={props.pageID}\n          pageIndex={props.pageIndex}\n        />\n      );\n    }\n  };\n\n  /**\n   * Page element\n   *\n   * @param props\n   *\n   * Show 'Page' or vertically scrollable text content.\n   * Text content on 'Page' breaks is separated horizontally.\n   */\n  Page = (props: { pageData: Page }): Element => (\n    <div\n      class={\n        \"page page__container page--multi animate-transition  theme--\" +\n        this.userPreferences.theme +\n        \" \" +\n        (props.pageData.attributes[\"class\"]\n          ? props.pageData.attributes[\"class\"].value\n          : \"\")\n      }\n      id={props.pageData[\"id\"]}\n    >\n      {\n        /* Display the PageCount only if there's more than 1 page */\n        this.parsed_text.length > 1 ? (\n          <this.PageCount\n            pgCount={this.parsed_text.length}\n            currentPage={this.parsed_text.indexOf(props.pageData) + 1}\n          />\n        ) : null\n      }\n      <this.ImgContainer\n        pageID={props.pageData.id}\n        pageIndex={this.parsed_text.indexOf(props.pageData)}\n      ></this.ImgContainer>\n      <div\n        class={\n          \"page__col__text paragraph__container theme--\" +\n          this.userPreferences.theme\n        }\n      >\n        {\n          /* Here are the Paragraph children */\n          props.pageData.paragraphs.map((paragraph: Element) => {\n            return (\n              <this.Paragraph\n                sentences={Array.from(paragraph.childNodes)}\n                attributes={paragraph.attributes}\n              />\n            );\n          })\n        }\n      </div>\n    </div>\n  );\n\n  /**\n   * Paragraph element\n   *\n   * @param props\n   *\n   * A paragraph element with one or more sentences\n   */\n  Paragraph = (props: {\n    sentences: Node[];\n    attributes: NamedNodeMap;\n  }): Element => (\n    <div\n      {...props.attributes}\n      class={\n        \"paragraph sentence__container theme--\" +\n        this.userPreferences.theme +\n        \" \" +\n        (props.attributes[\"class\"] ? props.attributes[\"class\"].value : \"\")\n      }\n    >\n      {\n        /* Here are the Sentence children */\n        props.sentences.map(\n          (sentence: Element) =>\n            sentence.childNodes.length > 0 && (\n              <this.Sentence sentenceData={sentence} />\n            ),\n        )\n      }\n    </div>\n  );\n\n  /**\n   * Sentence element\n   *\n   * @param props\n   *\n   * A sentence element with one or more words\n   */\n  Sentence = (props: { sentenceData: Element }): Element => {\n    let words: ChildNode[] = Array.from(props.sentenceData.childNodes);\n    let sentenceID: string = props.sentenceData.id;\n    if (!this.hasTextTranslations && props.sentenceData.hasAttribute(\"class\")) {\n      this.hasTextTranslations = /translation/.test(\n        props.sentenceData.getAttribute(\"class\"),\n      );\n    }\n    let nodeProps = {};\n    //attributes of sentence you want to retain\n    for (const attr of [\"annotation-id\", \"do-not-align\", \"lang\", \"id\"]) {\n      if (props.sentenceData.hasAttribute(attr)) {\n        nodeProps[attr] = props.sentenceData.getAttribute(attr);\n      }\n    }\n    if (props.sentenceData.hasAttribute(\"xml:lang\")) {\n      nodeProps[\"lang\"] = props.sentenceData.getAttribute(\"xml:lang\");\n    }\n    if (\n      this.mode === \"EDIT\" &&\n      /translation/.test(props.sentenceData.getAttribute(\"class\"))\n    )\n      return <Fragment></Fragment>;\n    return (\n      <div\n        {...nodeProps}\n        class={\n          \"sentence\" +\n          \" \" +\n          (props.sentenceData.hasAttribute(\"class\")\n            ? props.sentenceData.getAttribute(\"class\")\n            : \"\") +\n          (nodeProps[\"annotation-id\"] ? \" invisible\" : \"\")\n        }\n      >\n        {\n          /* Here are the Word and NonWordText children */\n          words.map((child: Element, c) => {\n            if (child.nodeName === \"#text\") {\n              return (\n                <this.NonWordText\n                  text={child.textContent}\n                  attributes={child.attributes}\n                  id={\n                    (props.sentenceData.hasAttribute(\"id\")\n                      ? props.sentenceData.getAttribute(\"id\")\n                      : \"P\") +\n                    \"text\" +\n                    c\n                  }\n                />\n              );\n            } else if (child.nodeName === \"w\" || child.nodeName === \"W\") {\n              /* It may be uppercase for embedded markup, because in\n                   that case it has been parsed as \"HTML\".  See\n                   https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeName */\n              return (\n                <this.Word\n                  text={child.textContent}\n                  id={child[\"id\"]}\n                  attributes={child.attributes}\n                />\n              );\n            } else if (child) {\n              let cnodeProps = {};\n              if (child.hasAttribute(\"xml:lang\"))\n                cnodeProps[\"lang\"] =\n                  props.sentenceData.getAttribute(\"xml:lang\");\n              if (child.hasAttribute(\"lang\"))\n                cnodeProps[\"lang\"] = props.sentenceData.getAttribute(\"lang\");\n              return (\n                <span\n                  {...cnodeProps}\n                  class={\n                    \"sentence__text theme--\" +\n                    this.userPreferences.theme +\n                    (\" \" + child.className)\n                  }\n                  id={child.id ? child.id : \"text_\" + c}\n                >\n                  {child.textContent}\n                </span>\n              );\n            }\n          })\n        }\n        {(() => {\n          if (\n            this.mode === \"EDIT\" &&\n            !/translation/.test(props.sentenceData.getAttribute(\"class\"))\n          ) {\n            if (\n              sentenceID in this.translations &&\n              sentenceID in this.translations &&\n              this.translations[sentenceID] !== null\n            ) {\n              return (\n                <span class=\"sentence__translation\">\n                  <button\n                    title=\"Remove translation\"\n                    aria-label=\"Remove translation\"\n                    data-test-id=\"remove-translation-button\"\n                    onClick={() => this.removeLine(props.sentenceData)}\n                    class=\"sentence__translation__button remove\"\n                  >\n                    <MatIcon>remove</MatIcon>\n                  </button>\n                  <p\n                    id={sentenceID + \"translation\"}\n                    data-test-id=\"translation-line\"\n                    class=\"sentence__text editable__translation\"\n                    onInput={(e: any) => {\n                      this.updateTranslation(\n                        sentenceID,\n                        e.currentTarget.innerText,\n                      );\n                    }}\n                    contentEditable\n                    onKeyDown={(event) => {\n                      if (event.key == \"Enter\") event.preventDefault();\n                    }}\n                    data-placeholder={this.getI18nString(\"line-placeholder\")}\n                    innerHTML={this.translations[sentenceID]}\n                  ></p>\n                </span>\n              );\n            } else {\n              return (\n                <button\n                  title={this.getI18nString(\"add-translation\")}\n                  aria-label=\"Add translation\"\n                  data-test-id=\"add-translation-button\"\n                  class=\"sentence__translation sentence__translation__button\"\n                  onClick={() => this.addLine(props.sentenceData)}\n                >\n                  <MatIcon>add</MatIcon>\n                </button>\n              );\n            }\n          } else {\n            return null;\n          }\n        })()}\n      </div>\n    );\n  };\n\n  /**\n   * A non-Word text element\n   *\n   * @param props\n   *\n   * This is an element that is a child to a Sentence element,\n   * but cannot be clicked and is not a word. This is usually\n   * inter-Word punctuation or other text.\n   */\n  NonWordText = (props: {\n    text: string;\n    id: string;\n    attributes: NamedNodeMap;\n  }): Element => {\n    let nodeProps = {};\n    if (props.attributes && props.attributes[\"xml:lang\"])\n      nodeProps[\"lang\"] = props.attributes[\"xml:lang\"].value;\n    if (props.attributes && props.attributes[\"lang\"])\n      nodeProps[\"lang\"] = props.attributes[\"lang\"].value;\n\n    return (\n      <span\n        {...nodeProps}\n        class={\"sentence__text theme--\" + this.userPreferences.theme}\n        id={props.id}\n      >\n        {props.text}\n      </span>\n    );\n  };\n\n  /**\n   * A Word text element\n   *\n   * @param props\n   *\n   * This is a clickable, audio-aligned Word element\n   */\n  Word = (props: {\n    id: string;\n    text: string;\n    attributes: NamedNodeMap;\n  }): Element => {\n    let nodeProps = {};\n    if (props.attributes && props.attributes[\"xml:lang\"])\n      nodeProps[\"lang\"] = props.attributes[\"xml:lang\"].value;\n    if (props.attributes && props.attributes[\"lang\"])\n      nodeProps[\"lang\"] = props.attributes[\"lang\"].value;\n\n    return (\n      <span\n        {...nodeProps}\n        class={\n          \"sentence__word theme--\" +\n          this.userPreferences.theme +\n          \" \" +\n          (props && props.attributes[\"class\"]\n            ? props.attributes[\"class\"].value\n            : \"\")\n        }\n        id={props.id}\n        onClick={(ev) => this.playSprite(ev)}\n      >\n        {props.text}\n      </span>\n    );\n  };\n  /**\n   * Render controls for ReadAlong\n   */\n\n  PlayControl = (): Element => (\n    <button\n      data-test-id=\"play-button\"\n      disabled={!this.isReadyToPlay()}\n      aria-label=\"Play\"\n      title={this.getI18nString(\"play-tooltip\")}\n      onClick={() => {\n        this.playing ? this.pause() : this.play();\n      }}\n      class={\n        \"control-panel__control ripple theme--\" +\n        this.userPreferences.theme +\n        \" background--\" +\n        this.userPreferences.theme\n      }\n      tabindex={1}\n    >\n      {this.playing ? <MatIcon>pause</MatIcon> : <MatIcon>play_arrow</MatIcon>}\n    </button>\n  );\n\n  ReplayControl = (): Element => (\n    <button\n      data-test-id=\"replay-button\"\n      disabled={this.hasLoaded < 2}\n      aria-label=\"Rewind\"\n      title={this.getI18nString(\"rewind-tooltip\")}\n      onClick={() => this.goBack(5)}\n      class={\n        \"control-panel__control ripple theme--\" +\n        this.userPreferences.theme +\n        \" background--\" +\n        this.userPreferences.theme\n      }\n    >\n      <MatIcon>replay_5</MatIcon>\n    </button>\n  );\n\n  StopControl = (): Element => (\n    <button\n      data-test-id=\"stop-button\"\n      disabled={this.hasLoaded < 2}\n      aria-label=\"Stop\"\n      title={this.getI18nString(\"stop-tooltip\")}\n      onClick={() => this.stop()}\n      class={\n        \"control-panel__control ripple theme--\" +\n        this.userPreferences.theme +\n        \" background--\" +\n        this.userPreferences.theme\n      }\n    >\n      <MatIcon>stop</MatIcon>\n    </button>\n  );\n\n  PlaybackSpeedControl = (): Element => (\n    <div>\n      <h5\n        class={\n          \"control-panel__buttons__header color--\" + this.userPreferences.theme\n        }\n        id=\"speed-slider-label\"\n      >\n        {this.getI18nString(\"speed\")}\n      </h5>\n      <input\n        type=\"range\"\n        min={100 - this.playbackRateRange}\n        max={100 + this.playbackRateRange}\n        value={this.playback_rate * 100}\n        class=\"slider control-panel__control\"\n        id=\"myRange\"\n        aria-labelledby=\"speed-slider-label\"\n        onInput={(v) => {\n          //console.log(\"v\", v);\n          this.changePlayback(v);\n        }}\n      />\n    </div>\n  );\n\n  StyleControl = (): Element => (\n    <button\n      aria-label=\"Change theme\"\n      title={this.getI18nString(\"theme-tooltip\")}\n      class={\n        \"control-panel__control ripple theme--\" +\n        this.userPreferences.theme +\n        \" background--\" +\n        this.userPreferences.theme\n      }\n    >\n      <MatIcon outline>style</MatIcon>\n    </button>\n  );\n\n  FullScreenControl = (): Element => (\n    <button\n      aria-label=\"Full screen mode\"\n      onClick={() => this.toggleFullscreen()}\n      title={this.getI18nString(\"full-screen-tooltip\")}\n      class={\n        \"control-panel__control ripple theme--\" +\n        this.userPreferences.theme +\n        \" background--\" +\n        this.userPreferences.theme\n      }\n    >\n      {this.fullscreen ? (\n        <MatIcon aria-label=\"Exit full screen mode\">fullscreen_exit</MatIcon>\n      ) : (\n        <MatIcon aria-label=\"Full screen mode\">fullscreen</MatIcon>\n      )}\n    </button>\n  );\n\n  TextAnnotationsControl = (): Element => (\n    <button\n      data-test-id=\"annotations-toggle\"\n      aria-label=\"Toggle Annotations\"\n      title={this.getI18nString(\"annotations-tooltip\")}\n      onClick={() =>\n        (this.annotationsMenuVisible = !this.annotationsMenuVisible)\n      }\n      class={\n        \"control-panel__control ripple theme--\" +\n        this.userPreferences.theme +\n        \" background--\" +\n        this.userPreferences.theme\n      }\n    >\n      <MatIcon outline>layers</MatIcon>\n    </button>\n  );\n\n  TextTranslationDisplayControl = (): Element => (\n    <button\n      data-test-id=\"translation-toggle\"\n      aria-label=\"Toggle Translation\"\n      title={this.getI18nString(\"translation-tooltip\")}\n      onClick={() => this.toggleTextTranslation()}\n      class={\n        \"control-panel__control ripple theme--\" +\n        this.userPreferences.theme +\n        \" background--\" +\n        this.userPreferences.theme\n      }\n    >\n      <MatIcon outline>subtitles</MatIcon>\n    </button>\n  );\n\n  ToggleSettingsControl = (): Element => (\n    <button\n      data-test-id={\"settings-button\"}\n      title={this.getI18nString(\"configuration-tooltip\")}\n      onClick={() => this.toggleSettings()}\n      id={\"settings-button\"}\n      class={\n        \"control-panel__control ripple theme--\" +\n        this.userPreferences.theme +\n        \" background--\" +\n        this.userPreferences.theme\n      }\n    >\n      <MatIcon aria-label=\"Show settings\">settings</MatIcon>\n    </button>\n  );\n\n  ControlPanel = (): Element => (\n    <div\n      data-test-id=\"control-panel\"\n      class={\n        \"control-panel theme--\" +\n        this.userPreferences.theme +\n        \" background--\" +\n        this.userPreferences.theme\n      }\n    >\n      <div class=\"control-panel__buttons--left\">\n        <this.PlayControl />\n        <this.ReplayControl />\n        <this.StopControl />\n      </div>\n\n      <div class=\"control-panel__buttons--center\">\n        <this.PlaybackSpeedControl />\n      </div>\n\n      <div class=\"control-panel__buttons--right\">\n        {this.annotations.length > 0 ? (\n          <this.TextAnnotationsControl />\n        ) : (\n          this.hasTextTranslations && <this.TextTranslationDisplayControl />\n        )}\n        {/* enable fullscreen button if supported*/}\n        {window.document.fullscreenEnabled && <this.FullScreenControl />}\n        <this.ToggleSettingsControl />\n      </div>\n    </div>\n  );\n\n  Settings = (): Element => (\n    <div\n      id={\"settings\"}\n      data-test-id={\"settings\"}\n      class={\"settings  theme--\" + this.userPreferences.theme}\n    >\n      <div class=\"header\">\n        <button\n          class={\"close\"}\n          data-test-id={\"settings-close-button\"}\n          onClick={() => {\n            this.toggleSettings();\n          }}\n        >\n          &times;{\" \"}\n        </button>\n        <h3>{this.getI18nString(\"settings\")}</h3>\n      </div>\n      <div class=\"content\">\n        <p>\n          <label>\n            <select\n              title={this.getI18nString(\"language\")}\n              onChange={(e) => {\n                const newLang = (e.target as HTMLSelectElement).value;\n                this.userPreferences = {\n                  ...this.userPreferences,\n                  language: newLang as InterfaceLanguage,\n                };\n                this.userPreferencesDirty = true;\n              }}\n              id=\"settings-language\"\n              data-test-id=\"settings-language\"\n              tabindex={2}\n            >\n              {Object.keys(this.i18nStrings).map((lang) => (\n                <option\n                  class={`background--${this.userPreferences.theme}`}\n                  selected={this.userPreferences.language == lang}\n                  value={lang}\n                >\n                  {this.i18nStrings[lang][lang] || lang}\n                </option>\n              ))}\n            </select>\n            {this.getI18nString(\"language\")}\n          </label>\n        </p>\n        <p\n          onClick={() => {\n            this.changeTheme();\n            this.userPreferencesDirty = true;\n          }}\n          tabindex={3}\n        >\n          <this.StyleControl />\n          {this.getI18nString(\"theme-tooltip\")}\n        </p>\n\n        <p\n          onClick={() => {\n            this.toggleScrollBehavior();\n            this.userPreferencesDirty = true;\n          }}\n          tabindex={4}\n        >\n          <button\n            class={\n              \"control-panel__control  ripple theme--\" +\n              this.userPreferences.theme +\n              \" background--\" +\n              this.userPreferences.theme\n            }\n            title={this.getI18nString(\"page-animation\")}\n            data-test-id={\"settings-scroll-behavior\"}\n          >\n            {this.userPreferences.scrollBehaviour === \"smooth\" ? (\n              <MatIcon outline>check_box</MatIcon>\n            ) : (\n              <MatIcon outline>check_box_outline_blank</MatIcon>\n            )}\n          </button>\n          {this.getI18nString(\"page-animation\")}\n        </p>\n        <p\n          onClick={() => {\n            this.userPreferences = {\n              ...this.userPreferences,\n              autoPauseAtEndOfPage: !this.userPreferences.autoPauseAtEndOfPage,\n            };\n            this.userPreferencesDirty = true;\n          }}\n          tabindex={5}\n        >\n          <button\n            class={\n              \"control-panel__control  ripple theme--\" +\n              this.userPreferences.theme +\n              \" background--\" +\n              this.userPreferences.theme\n            }\n            title={this.getI18nString(\"auto-pause\")}\n            data-test-id={\"settings-auto-pause\"}\n          >\n            {this.userPreferences.autoPauseAtEndOfPage ? (\n              <MatIcon outline>check_box</MatIcon>\n            ) : (\n              <MatIcon outline>check_box_outline_blank</MatIcon>\n            )}\n          </button>\n          {this.getI18nString(\"auto-pause\")}\n        </p>\n        <div class=\"preference-btns\">\n          <button\n            type=\"button\"\n            class={\n              \"control-panel__control  ripple theme--\" +\n              this.userPreferences.theme +\n              \" background--\" +\n              this.userPreferences.theme\n            }\n            title={this.getI18nString(\"save-settings\")}\n            onClick={() => {\n              setUserPreferences(this.userPreferences);\n              this.userPreferencesDirty = false;\n              this.hasUserPreferences = true;\n            }}\n            data-test-id={\"settings-save\"}\n            disabled={!this.userPreferencesDirty}\n            tabindex={6}\n          >\n            {this.getI18nString(\"save-settings\")}\n          </button>\n        </div>\n        <p class=\"version\">\n          @readalongs/web-component version: {PACKAGE_VERSION}\n        </p>\n      </div>\n      <div class=\"footer\">\n        <button\n          type=\"button\"\n          class={\n            \"control-panel__control ripple\" +\n            ` theme--${this.userPreferences.theme}` +\n            ` background--${this.userPreferences.theme}`\n          }\n          title={this.getI18nString(\"reset-title\")}\n          onClick={() => {\n            clearUserPreferences();\n            this.userPreferences = this.defaultUserPreferences();\n            this.userPreferencesDirty = false;\n            this.hasUserPreferences = false;\n          }}\n          data-test-id={\"reset\"}\n          disabled={!this.hasUserPreferences && !this.userPreferencesDirty}\n          tabindex={7}\n        >\n          {this.getI18nString(\"reset\")}\n        </button>\n        <button\n          onClick={() => this.toggleSettings()}\n          class={\n            \"control-panel__control  ripple theme--\" +\n            this.userPreferences.theme +\n            \" background--\" +\n            this.userPreferences.theme\n          }\n          tabindex={8}\n        >\n          {this.getI18nString(\"close\")}\n        </button>\n      </div>\n    </div>\n  );\n\n  AnnotationsMenu = (): Element => {\n    return (\n      <div\n        id=\"annotationsMenu\"\n        class={\"annotations-menu  theme--\" + this.userPreferences.theme}\n      >\n        {/*<h3 class={\"theme--\" + this.userPreferences.theme}> {this.getI18nString(\"annotation-layers\")}</h3> */}\n        {this.annotations.map((annotation) => (\n          <button\n            data-test-id={\"toggle-annotation-\" + annotation.id}\n            class={\n              \"ripple theme--\" +\n              this.userPreferences.theme +\n              \" background--\" +\n              this.userPreferences.theme\n            }\n            onClick={() => this.toggleTextAnnotation(annotation.id)}\n          >\n            {annotation.isVisible ? (\n              <MatIcon outline>check_box</MatIcon>\n            ) : (\n              <MatIcon outline>check_box_outline_blank</MatIcon>\n            )}\n            {annotation.name}\n          </button>\n        ))}\n        <button\n          data-test-id=\"toggle-all-annotations\"\n          class={\n            \"ripple theme--\" +\n            this.userPreferences.theme +\n            \" background--\" +\n            this.userPreferences.theme\n          }\n          onClick={() => this.toggleTextAnnotation(\"*\")}\n        >\n          <MatIcon outline>layers</MatIcon> All\n        </button>\n      </div>\n    );\n  };\n\n  /**\n   * Render main component\n   */\n  render(): Element {\n    return (\n      <div id=\"read-along-container\" class=\"read-along-container\">\n        <div id=\"title__slot__container\">\n          <h1 class=\"slot__header\">\n            <slot name=\"read-along-header\" />\n          </h1>\n          <h3 class=\"slot__subheader\">\n            <slot name=\"read-along-subheader\" />\n          </h3>\n        </div>\n        {Object.entries(this.assetsStatus).map(([assetType, code]) => {\n          if (code === ERROR_PARSING) {\n            let path = this.getPathFromAssetType(assetType);\n            return (\n              <error-message\n                msg={this.getI18nString(\"parse-error\", {\n                  FILETYPE: assetType,\n                  FILENAME: path,\n                })}\n                data_cy={assetType + \"-error\"}\n              />\n            );\n          }\n          if (code === ERROR_LOADING) {\n            let path = this.getPathFromAssetType(assetType);\n            return (\n              <error-message\n                msg={this.getI18nString(\"loading-error\", {\n                  FILETYPE: assetType,\n                  FILENAME: path,\n                })}\n                data_cy={assetType + \"-error\"}\n              />\n            );\n          }\n        })}\n\n        {this.alignment_failed && this.assetsStatus.RAS === LOADED && (\n          <error-message\n            msg={this.getI18nString(\"alignment-error\")}\n            data_cy=\"alignment-error\"\n          />\n        )}\n\n        {this.assetsStatus.RAS === LOADED &&\n          Object.values(this.invalidImages).map((invalidImage) => {\n            return (\n              <error-message\n                msg={this.getI18nString(\"image-error\", {\n                  FILENAME: invalidImage.fileName,\n                  PAGENUMBER: (invalidImage.pageIndex + 1).toString(),\n                })}\n                timeout={DEFAULT_ERROR_TIMEOUT_MS}\n                data_cy=\"invalid-image-file\"\n                onExpired={() => {\n                  // we don't need to be reactive here, the error message\n                  // is no longer visible it is sufficient to remove\n                  // its entry from the invalidImages object.\n                  delete this.invalidImages[invalidImage.pageIndex];\n                }}\n              />\n            );\n          })}\n\n        <div\n          onScroll={() => {\n            this.handleScrollEvent();\n          }}\n          data-test-id=\"text-container\"\n          class={\n            \"pages__container\" +\n            \" theme--\" +\n            this.userPreferences.theme +\n            \" \" +\n            this.pageScrolling\n          }\n        >\n          {this.showGuide ? <this.Guide /> : null}\n          {this.assetsStatus.RAS == LOADED &&\n            this.parsed_text.map((page) => (\n              <this.Page pageData={page}></this.Page>\n            ))}\n          {this.hasLoaded < 2 && <div class=\"loader\" />}\n        </div>\n        {this.settingsVisible && (\n          <div\n            class=\"settings-background\"\n            onClick={() => (this.settingsVisible = false)}\n          ></div>\n        )}\n        {this.settingsVisible && <this.Settings />}\n\n        {this.alignment_failed || (\n          <div\n            onClick={(e) => this.goToSeekFromProgress(e)}\n            id=\"all\"\n            data-test-id=\"progress-bar\"\n            class={\n              \"overlay__container theme--\" +\n              this.userPreferences.theme +\n              \" background--\" +\n              this.userPreferences.theme\n            }\n          >\n            {this.svgOverlay ? <this.Overlay /> : null}\n          </div>\n        )}\n        {this.annotationsMenuVisible && <this.AnnotationsMenu />}\n        {this.assetsStatus.AUDIO == LOADED && <this.ControlPanel />}\n\n        {this.cssUrl && this.cssUrl.match(\".css\") != null && (\n          <link href={this.cssUrl} rel=\"stylesheet\" />\n        )}\n      </div>\n    );\n  }\n}\n"]}